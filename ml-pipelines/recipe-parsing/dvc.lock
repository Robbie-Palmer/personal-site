schema: '2.0'
stages:
  prepare:
    cmd: pnpm exec tsx src/stages/prepare.ts
    deps:
    - path: data/ground-truth.json
      hash: md5
      md5: b8da2211c2d65c6bc105e993b8f08b71
      size: 43985
    - path: data/recipe-images
      hash: md5
      md5: c016e91ef929d55fd41a2fb90521e92b.dir
      size: 84063465
      nfiles: 14
    - path: src/lib/io.ts
      hash: md5
      md5: ba4f877e8bf3a64647f7bb79fc3b7844
      size: 2656
    - path: src/schemas/ground-truth.ts
      hash: md5
      md5: 3719b427c4e651040d0f72eb95a1357b
      size: 1351
    - path: src/stages/prepare.ts
      hash: md5
      md5: c065734c2c84c5539d937071f33952f8
      size: 1128
    outs:
    - path: outputs/prepared.json
      hash: md5
      md5: 1f10cd16f160dc2eac2d7421d2c1b26e
      size: 43985
  infer:
    cmd: pnpm exec tsx src/stages/infer.ts
    deps:
    - path: data/recipe-images
      hash: md5
      md5: c016e91ef929d55fd41a2fb90521e92b.dir
      size: 84063465
      nfiles: 14
    - path: outputs/prepared.json
      hash: md5
      md5: 1f10cd16f160dc2eac2d7421d2c1b26e
      size: 43985
    - path: src/lib/env.ts
      hash: md5
      md5: 1ad5cf2fca9426a8faa637e965f84001
      size: 196
    - path: src/lib/images.ts
      hash: md5
      md5: 53ebc03d0d7f1458e412daccd17eb54e
      size: 560
    - path: src/lib/infer-retry.ts
      hash: md5
      md5: 402a819eb2107f1d3074e3363216bdc1
      size: 1720
    - path: src/lib/io.ts
      hash: md5
      md5: ba4f877e8bf3a64647f7bb79fc3b7844
      size: 2656
    - path: src/lib/openrouter.ts
      hash: md5
      md5: f8d8a6c3ea806969a6d04e3fb0a75550
      size: 1896
    - path: src/lib/recipe-output.ts
      hash: md5
      md5: d11742cd8cfb704a3134a64f1b8a40cd
      size: 1814
    - path: src/schemas/ground-truth.ts
      hash: md5
      md5: 3719b427c4e651040d0f72eb95a1357b
      size: 1351
    - path: src/stages/infer.ts
      hash: md5
      md5: d427bda4efea10f222e485a656521bd4
      size: 11327
    outs:
    - path: outputs/infer-failures.json
      hash: md5
      md5: 49e4c30c06bf51cc81392193d431c87d
      size: 20
    - path: outputs/predictions.json
      hash: md5
      md5: 97caeb9a0c693107fcc41f8a74633831
      size: 26045
  evaluate:
    cmd: pnpm exec tsx src/stages/evaluate.ts
    deps:
    - path: outputs/predictions-normalized.json
      hash: md5
      md5: 2fc87c49bb13d72b145e92dbbcf7ec86
      size: 25940
    - path: outputs/prepared.json
      hash: md5
      md5: 1f10cd16f160dc2eac2d7421d2c1b26e
      size: 43985
    - path: src/evaluation/metrics.ts
      hash: md5
      md5: 415ff3541c57e7b88b388bbd959aef08
      size: 9972
    - path: src/lib/io.ts
      hash: md5
      md5: ba4f877e8bf3a64647f7bb79fc3b7844
      size: 2656
    - path: src/stages/evaluate.ts
      hash: md5
      md5: 252aa3076d5f738c610398adc85c0a61
      size: 1683
    outs:
    - path: outputs/metrics.json
      hash: md5
      md5: ffa942daf6561a8fe8b13a303d3fdd1a
      size: 1263
    - path: outputs/per-image-scores.json
      hash: md5
      md5: f164e0acdb0a798e7e465228e80eb330
      size: 2680
  normalize:
    cmd: pnpm exec tsx src/stages/normalize.ts
    deps:
    - path: outputs/predictions.json
      hash: md5
      md5: 97caeb9a0c693107fcc41f8a74633831
      size: 26045
    - path: outputs/prepared.json
      hash: md5
      md5: 1f10cd16f160dc2eac2d7421d2c1b26e
      size: 43985
    - path: src/lib/ingredient-normalization.ts
      hash: md5
      md5: 09e87949b85672dacb4fe06595c215db
      size: 11146
    - path: src/lib/io.ts
      hash: md5
      md5: ba4f877e8bf3a64647f7bb79fc3b7844
      size: 2656
    - path: src/schemas/ground-truth.ts
      hash: md5
      md5: 3719b427c4e651040d0f72eb95a1357b
      size: 1351
    - path: src/stages/normalize.ts
      hash: md5
      md5: 018c48c47a369b43cf9877643fe7b2cb
      size: 2132
    outs:
    - path: outputs/normalization-decisions.json
      hash: md5
      md5: 73bf628c1c6053d0e345cfa1a37e7280
      size: 52203
    - path: outputs/predictions-normalized.json
      hash: md5
      md5: 2fc87c49bb13d72b145e92dbbcf7ec86
      size: 25940
  normalization_audit:
    cmd: pnpm exec tsx src/stages/normalization-audit.ts
    deps:
    - path: outputs/normalization-decisions.json
      hash: md5
      md5: e81d64f2a442c13762eb11d3debe117f
      size: 51268
    - path: src/lib/ingredient-normalization.ts
      hash: md5
      md5: 846d34f7073786e7f69bf67566629299
      size: 11303
    - path: src/lib/io.ts
      hash: md5
      md5: 3a3cf8db83c8cf6f57b0b1e9701fddfe
      size: 3524
    - path: src/stages/normalization-audit.ts
      hash: md5
      md5: 7af17b4e6bf1fe0e1a3b6c11328296f6
      size: 3795
    outs:
    - path: outputs/normalization-audit.json
      hash: md5
      md5: 458e4c3a05c6c3537b8b177cf7998696
      size: 12921
    - path: outputs/normalization-audit.md
      hash: md5
      md5: a9a9815b7fd6805d09f8c8615a7d3fd7
      size: 2297
  review:
    cmd: pnpm exec tsx src/stages/review.ts
    deps:
    - path: outputs/infer-failures.json
      hash: md5
      md5: 49e4c30c06bf51cc81392193d431c87d
      size: 20
    - path: outputs/metrics.json
      hash: md5
      md5: ecd283480319ec9eb2ece88a9b64290e
      size: 1264
    - path: outputs/per-image-scores.json
      hash: md5
      md5: 5b532575c8298b964838293d9c57c928
      size: 2665
    - path: outputs/predictions-normalized.json
      hash: md5
      md5: 4958d3b573d10c9b12da61873b7fb3c5
      size: 26858
    - path: outputs/prepared.json
      hash: md5
      md5: 1f10cd16f160dc2eac2d7421d2c1b26e
      size: 43985
    - path: src/evaluation/metrics.ts
      hash: md5
      md5: 415ff3541c57e7b88b388bbd959aef08
      size: 9972
    - path: src/lib/io.ts
      hash: md5
      md5: 3a3cf8db83c8cf6f57b0b1e9701fddfe
      size: 3524
    - path: src/review/category-analysis.ts
      hash: md5
      md5: 60b39defdac0001a62a8f3589487e915
      size: 2483
    - path: src/review/entry-diff.ts
      hash: md5
      md5: c6ed788372ff0091f3276504f9151a77
      size: 7008
    - path: src/review/insights.ts
      hash: md5
      md5: 00c1a07d8e32bed8d129e5f11a665135
      size: 4633
    - path: src/review/rankings.ts
      hash: md5
      md5: e855f8b3d84a824c788779d9475de0ad
      size: 1005
    - path: src/review/summary-markdown.ts
      hash: md5
      md5: b8337db616d513f7efe36ce37dc9ab6e
      size: 2596
    - path: src/review/types.ts
      hash: md5
      md5: 99dfcece879b945ec7522da7255aeabc
      size: 2620
    - path: src/stages/review.ts
      hash: md5
      md5: e0cafe7a302620e32f070dc0d7573598
      size: 5170
    outs:
    - path: outputs/review
      hash: md5
      md5: 1a1e80c658c3d95b35ae39515ad95c45.dir
      size: 160654
      nfiles: 13
  analyze:
    cmd: pnpm exec tsx src/stages/analyze.ts
    deps:
    - path: outputs/metrics.json
      hash: md5
      md5: ecd283480319ec9eb2ece88a9b64290e
      size: 1264
    - path: outputs/per-image-scores.json
      hash: md5
      md5: 5b532575c8298b964838293d9c57c928
      size: 2665
    - path: outputs/predictions-normalized.json
      hash: md5
      md5: 4958d3b573d10c9b12da61873b7fb3c5
      size: 26858
    - path: outputs/prepared.json
      hash: md5
      md5: 1f10cd16f160dc2eac2d7421d2c1b26e
      size: 43985
    - path: src/evaluation/metrics.ts
      hash: md5
      md5: 415ff3541c57e7b88b388bbd959aef08
      size: 9972
    - path: src/lib/io.ts
      hash: md5
      md5: 3a3cf8db83c8cf6f57b0b1e9701fddfe
      size: 3524
    - path: src/schemas/ground-truth.ts
      hash: md5
      md5: 3719b427c4e651040d0f72eb95a1357b
      size: 1351
    - path: src/stages/analyze.ts
      hash: md5
      md5: ad19429bd8a06bc528c6c4244761dd98
      size: 14768
    outs:
    - path: outputs/failure-analysis.json
      hash: md5
      md5: dfe65b8bb5f3feaf442eefa51823b9cc
      size: 7644
    - path: outputs/failure-analysis.md
      hash: md5
      md5: a4fc7579ecc30e0b76998d9ddcd30949
      size: 3741
  infer_diagnose:
    cmd: pnpm exec tsx src/stages/infer-diagnose.ts
    deps:
    - path: outputs/infer-failures.json
      hash: md5
      md5: 49e4c30c06bf51cc81392193d431c87d
      size: 20
    - path: src/lib/io.ts
      hash: md5
      md5: 3a3cf8db83c8cf6f57b0b1e9701fddfe
      size: 3524
    - path: src/schemas/infer-failures.ts
      hash: md5
      md5: 377c5d1cd4112e74530ff45f2db189dd
      size: 1305
    - path: src/stages/infer-diagnose.ts
      hash: md5
      md5: dfe84ae1cb022b6599be7f3536d48a76
      size: 4144
    outs:
    - path: outputs/infer-failure-summary.json
      hash: md5
      md5: 2ba02b418121bed64e7aebddffe30774
      size: 161
    - path: outputs/infer-failure-summary.md
      hash: md5
      md5: be1b46a066f684a208d1afb7a534df7f
      size: 154
  hypothesize:
    cmd: pnpm exec tsx src/stages/hypothesize.ts
    deps:
    - path: outputs/failure-analysis.json
      hash: md5
      md5: dfe65b8bb5f3feaf442eefa51823b9cc
      size: 7644
    - path: outputs/review
      hash: md5
      md5: 1a1e80c658c3d95b35ae39515ad95c45.dir
      size: 160654
      nfiles: 13
    - path: src/iteration/hypothesis-builder.ts
      hash: md5
      md5: eb4a5aa979bf4d8d52dcc91f0d43f044
      size: 6966
    - path: src/lib/io.ts
      hash: md5
      md5: 3a3cf8db83c8cf6f57b0b1e9701fddfe
      size: 3524
    - path: src/review/types.ts
      hash: md5
      md5: 99dfcece879b945ec7522da7255aeabc
      size: 2620
    - path: src/schemas/hypotheses.ts
      hash: md5
      md5: bc64b26463b03ea8b33dfccaec52cf16
      size: 2638
    - path: src/stages/hypothesize.ts
      hash: md5
      md5: d7eef38793778e3d3b592bdd700abb8d
      size: 2206
    outs:
    - path: outputs/hypotheses.json
      hash: md5
      md5: 0ea0ea88e2f3b0e0eb5ceaae67b96713
      size: 8839
    - path: outputs/hypotheses.md
      hash: md5
      md5: 79954ff2a76424b66003a8ea04ed5502
      size: 1876
  evaluate_slices:
    cmd: pnpm exec tsx src/stages/evaluate-slices.ts
    deps:
    - path: outputs/review
      hash: md5
      md5: 1a1e80c658c3d95b35ae39515ad95c45.dir
      size: 160654
      nfiles: 13
    - path: src/iteration/slice-metrics.ts
      hash: md5
      md5: 39e04a6c0da01de848a8f9842b6752ff
      size: 4199
    - path: src/lib/io.ts
      hash: md5
      md5: 3a3cf8db83c8cf6f57b0b1e9701fddfe
      size: 3524
    - path: src/review/types.ts
      hash: md5
      md5: 99dfcece879b945ec7522da7255aeabc
      size: 2620
    - path: src/schemas/hypotheses.ts
      hash: md5
      md5: bc64b26463b03ea8b33dfccaec52cf16
      size: 2638
    - path: src/stages/evaluate-slices.ts
      hash: md5
      md5: f6681e378522237274366717b754c6c2
      size: 1367
    outs:
    - path: outputs/slice-metrics.json
      hash: md5
      md5: be281061d77979523d059a68b175a9bb
      size: 4158
    - path: outputs/slice-metrics.md
      hash: md5
      md5: e32787569fb4606cbb82a89efa9fdb9d
      size: 608
  gt_audit:
    cmd: pnpm exec tsx src/stages/gt-audit.ts
    deps:
    - path: outputs/failure-analysis.json
      hash: md5
      md5: dfe65b8bb5f3feaf442eefa51823b9cc
      size: 7644
    - path: outputs/prepared.json
      hash: md5
      md5: 1f10cd16f160dc2eac2d7421d2c1b26e
      size: 43985
    - path: outputs/review
      hash: md5
      md5: 1a1e80c658c3d95b35ae39515ad95c45.dir
      size: 160654
      nfiles: 13
    - path: src/iteration/gt-audit.ts
      hash: md5
      md5: 23e30b4b01344474717860fb81c18980
      size: 5672
    - path: src/lib/io.ts
      hash: md5
      md5: 3a3cf8db83c8cf6f57b0b1e9701fddfe
      size: 3524
    - path: src/review/types.ts
      hash: md5
      md5: 99dfcece879b945ec7522da7255aeabc
      size: 2620
    - path: src/schemas/ground-truth.ts
      hash: md5
      md5: 3719b427c4e651040d0f72eb95a1357b
      size: 1351
    - path: src/schemas/hypotheses.ts
      hash: md5
      md5: bc64b26463b03ea8b33dfccaec52cf16
      size: 2638
    - path: src/stages/gt-audit.ts
      hash: md5
      md5: 54f6c48f6eb221781c1b0d1b3e339b65
      size: 1553
    outs:
    - path: outputs/gt-audit.json
      hash: md5
      md5: d481439393c991ea9274d43ea15dfb55
      size: 4066
    - path: outputs/gt-audit.md
      hash: md5
      md5: 2c5c7570f2e3885de3b59b19be1f88b7
      size: 2767
  iteration_report:
    cmd: pnpm exec tsx src/stages/iteration-report.ts
    deps:
    - path: outputs/gt-audit.md
      hash: md5
      md5: 2c5c7570f2e3885de3b59b19be1f88b7
      size: 2767
    - path: outputs/hypotheses.md
      hash: md5
      md5: 79954ff2a76424b66003a8ea04ed5502
      size: 1876
    - path: outputs/metrics.json
      hash: md5
      md5: ecd283480319ec9eb2ece88a9b64290e
      size: 1264
    - path: outputs/normalization-audit.md
      hash: md5
      md5: a9a9815b7fd6805d09f8c8615a7d3fd7
      size: 2297
    - path: outputs/review/summary.md
      hash: md5
      md5: eae75e38372dbe01033e3fb19282d24e
      size: 1972
    - path: outputs/slice-metrics.md
      hash: md5
      md5: e32787569fb4606cbb82a89efa9fdb9d
      size: 608
    - path: src/lib/io.ts
      hash: md5
      md5: 3a3cf8db83c8cf6f57b0b1e9701fddfe
      size: 3524
    - path: src/stages/iteration-report.ts
      hash: md5
      md5: 696104283825f8b8930e3443235061e0
      size: 2769
    outs:
    - path: outputs/iteration-report.md
      hash: md5
      md5: 2b9c07b098862f68e6a0016105ba4139
      size: 9808
